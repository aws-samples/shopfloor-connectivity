# Shopfloor Connectivity Framework (SFC)

## WIP: Tenets for that README

- KISS
- in describing text - link to docs/README.md using markdown-refs
- Sequence could be:
  - What is SFC?
    - How does it fit into IDF & UNS patterns
  - How can I run it locally to test out things? (for HellowWorld use sfc artifacts from here: <https://dyy8lqvmsyeqk.cloudfront.net/>)
    - show off mock-up data sources like opcua/plcsim and pipe to IoT Core & Sitewise
    - create catchy screen-capture gifs showing sources & target raw data streams
  - How can I configure it?
  - How can I deploy it using Greengrass deployments?
  - How can I build it?
  - How can I write my own adapters?

## Introduction

Shop Floor Connectivity (SFC) is a data ingestion technology that can deliver data to multiple AWS Services.

SFC addresses limitations of, and unifies data collection of our existing IoT data collection services, allowing customers to collect data in a consistent way to any AWS Service, not just the AWS IoT Services, that can collect and process data. It allows customers to collect data from their industrial equipment and deliver it the AWS services that work best for their requirements. Customers get the cost and functional benefits of specific AWS services and save costs on licenses for additional connectivity products.

### SFC Components

There are three main type of components that make up SFC.

- Protocol Adapters
- SFC Core
- Target Adapters

<p align="center">
  <img src="docs/img/fig01.png" width="75%"/>
</p>
<p align="center">
    <em>Fig. 1. SFC components</em>
</p>

[Read more](docs/README.md/#introduction)

## Quick start - With SFC Bundles

### Requirements
- Finch
- AWS cli
- java Runtime

### Installation
In this Quick start you will set up following architecture. The local SFC installation will receive data from an OPC UA server and send it according to its' configuration to an S3 Bucket:

<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="480px" height="360px" viewBox="-0.5 -0.5 480 360" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2023-11-07T20:11:35.192Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.6.5 Chrome/114.0.5735.243 Electron/25.3.1 Safari/537.36&quot; version=&quot;21.6.5&quot; etag=&quot;qPVmaK0Ga-7DgDAiFdNm&quot; type=&quot;device&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;zGOO2Zk3jegYYXlppcc_&quot;&gt;7Vhbb+I4FP41eVxEYpLAI5d2tlJXWwmt5rFyE5O448TIMQXm1+8xtgnG7tDdMhIjTS/C/nxOfPydm0mE5s3ui8Dr+i9eEhYlw3IXoUWUJPEwyeBDIXuN5COkgUrQ0gj1wJJ+J1bToBtaks4RlJwzSdcuWPC2JYV0MCwE37piK87cXde4Ih6wLDDz0a+0lLVGx0ne438SWtV25zib6JUGW2Fzkq7GJd+eQOguQnPBudSjZjcnTJFnedF69++sHg0TpJUfUUi0whtmG3M2Y5fc28MKvmlLouSHEZptayrJco0LtboF9wJWy4bBLIZhJwX/RuaccQFIy1sQm5k9iJBk966d8fH0EDaEN0SKPYhYhcwQtreRYObbnv/R2GD1CffIKmLj8+r47J4WGBhmwiwhj6Xp1yUAc8Y3pUdY943IojZ88Y1ktAVGbCQOXcJCfK54K03Qx4mdm+crdQiatRo3u0rl1wBvu9GgAj8p5Uo8QNgHV59h+FwcbEYz5Q4KIT1ltFLikittbGaMrKTaCQyjbfV4mC2Q2rzEXX2Mhit49ug169mR79kYxb5nk/EVPDvyPMs4kPIL+ZS3z2tBGtqRG3JqPLns1CQLpOtVnJp67iMl1G8z5ULWvOItZnc9OnOrXC/zyBWFB7e+Ein3xod4I7nrdL2n2sjhrOMbURjIdD2JRUXMeScfZlYQhiV9c58eYsmoPnEKT+zTDLkeSdIzorVVRqvneioE3p+IrZVA94N9hu4+KE7dBnRB3trVu1pb0Dv+yMmHYiHzEnx5D0rDh7aTmClKIbH+e7ar9LVdLkoQ/N6r/SFTcUlJv2Y64Ioydi6+eK9dOsloM/oRvxD2xDt6MBgtXriUvLmY8gXYQoQbqZdKEe7W+qArulN2zA4+J+LujSjXm0YfqldSnV4ZiNlzR8TbYecrlBNk74c2SMapV07QaJAlfkG5RvvPb7SejP16kl2/nnyUpbGXadCzVrSKkoyptvMiYFSp0eC1CyTdpZvlWcC94I4Wg5IXm4aYkvXZIBsO8rEbZ7HfttBkkAVuI+fl9P8wOPGvmQ3+rqgaLtGPi5Qpy7CQzuAPjJnr/xRE5woZqLbogSEs98HYF4OPOLTDORjCch+MfTE1s1a7YAjLU9/ic+04oB2faaeLz9b8SH3pmCKUn6wtqIAH6dLdqmoQaAp5Dl8UvaYAK6vDzy12hmAXEEQXKX1nncE0dHvt0HV6Q2pVbM4mfs6mk0DCTj6fsLY83FxniO1bkdtoDdack8r299P8n+kfS31J+H3/uu37VzI6u6T/1PsXTPsXYPrK379GRHf/Ag==&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><linearGradient x1="0%" y1="100%" x2="0%" y2="0%" id="mx-gradient-60a337-1-277116-1-s-0"><stop offset="0%" style="stop-color: rgb(39, 113, 22); stop-opacity: 1;"/><stop offset="100%" style="stop-color: rgb(96, 163, 55); stop-opacity: 1;"/></linearGradient></defs><g><rect x="0" y="0" width="480" height="360" fill="rgb(255, 255, 255)" stroke="none" pointer-events="all"/><path d="M 320 40 L 451 40 L 451 320 L 320 320 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 330.73 46.89 C 328.19 46.86 326.05 49.34 326.28 51.84 C 324.63 52.3 323.58 54.09 323.93 55.76 C 324.17 57.45 325.84 58.8 327.55 58.58 C 331.3 58.56 335.05 58.61 338.79 58.55 C 340.71 58.38 342.05 56.29 341.58 54.45 C 341.34 53.13 340.21 51.98 338.87 51.81 C 338.86 50.3 337.26 48.82 335.79 49.6 C 334.97 50.39 334.82 48.44 334.02 48.13 C 333.14 47.28 331.95 46.82 330.73 46.89 Z M 330.75 47.63 C 332.68 47.51 334.32 49.05 334.91 50.79 C 335.31 51.19 335.67 50.52 335.97 50.34 C 337.25 49.57 338.21 51.17 338.23 52.29 C 338.58 52.77 339.39 52.38 339.77 52.91 C 341.21 53.93 341.3 56.3 339.88 57.37 C 338.9 58.09 337.63 57.75 336.5 57.83 C 333.28 57.82 330.06 57.84 326.84 57.82 C 325.2 57.58 324.19 55.69 324.79 54.17 C 325.07 53.16 326.05 52.67 326.94 52.36 C 327.19 51.62 326.85 50.71 327.33 49.99 C 327.92 48.65 329.25 47.61 330.75 47.63 Z M 320 65 C 320 56.67 320 48.33 320 40 C 328.33 40 336.67 40 345 40 C 345 48.33 345 56.67 345 65 C 336.67 65 328.33 65 320 65 Z" fill="rgb(0, 0, 0)" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 99px; height: 1px; padding-top: 47px; margin-left: 352px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">AWS Cloud</div></div></div></foreignObject><text x="352" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">AWS Cloud</text></switch></g><path d="M 30 40 L 290 40 L 290 320 L 30 320 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 39.02 52.33 L 39.02 53.08 L 45.99 53.08 L 45.99 52.33 Z M 39.02 49.28 L 39.02 50.03 L 45.99 50.03 L 45.99 49.28 Z M 39.02 46.24 L 39.02 46.99 L 45.99 46.99 L 45.99 46.24 Z M 37.64 43.73 C 37.44 43.73 37.27 43.9 37.27 44.11 L 37.27 61.5 C 37.27 61.71 37.44 61.87 37.64 61.87 L 47.37 61.87 C 47.58 61.87 47.75 61.71 47.75 61.5 L 47.75 44.11 C 47.75 43.9 47.58 43.73 47.37 43.73 Z M 38.02 44.48 L 47 44.48 L 47 61.12 L 38.02 61.12 Z M 30 65 L 30 40 L 55 40 L 55 65 Z" fill="rgb(0, 0, 0)" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 228px; height: 1px; padding-top: 47px; margin-left: 62px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">local</div></div></div></foreignObject><text x="62" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">local</text></switch></g><path d="M 217.62 215 L 240 215 L 240 150 L 354.63 150" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 359.88 150 L 352.88 153.5 L 354.63 150 L 352.88 146.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="183" y="185" width="34.62" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 215.63 185.12 L 184.99 185.12 C 183.89 185.12 183 186.02 183 187.12 L 183 242.89 C 183 243.98 183.89 244.88 184.99 244.88 L 215.63 244.88 C 216.73 244.88 217.62 243.98 217.62 242.89 L 217.62 187.12 C 217.62 186.02 216.73 185.12 215.63 185.12 Z M 185.72 242.16 L 185.72 187.84 L 214.9 187.84 L 214.9 242.16 Z M 189.02 193.94 L 211.6 193.94 L 211.6 191.22 L 189.02 191.22 Z M 189.02 199.73 L 211.6 199.73 L 211.6 197.02 L 189.02 197.02 Z M 189.02 205.75 L 211.6 205.75 L 211.6 203.04 L 189.02 203.04 Z M 189.02 211.62 L 211.6 211.62 L 211.6 208.91 L 189.02 208.91 Z" fill="#232f3d" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 252px; margin-left: 200px;"><div data-drawio-colors="color: #232F3E; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(35, 47, 62); line-height: 1.2; pointer-events: all; white-space: nowrap;">SFC Installation</div></div></div></foreignObject><text x="200" y="264" fill="#232F3E" font-family="Helvetica" font-size="12px" text-anchor="middle">SFC In...</text></switch></g><path d="M 200.6 160 L 200.6 180 L 200.67 178.76" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 200.37 184.01 L 197.28 176.81 L 200.67 178.76 L 204.27 177.22 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 219.99 117.14 L 219.99 160 L 180.78 160 L 180.78 110 L 214.39 110 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 214.39 110 C 214.84 111.67 214.09 113.39 212.39 114.59 L 219.99 117.3" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 135px; margin-left: 182px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">config<br />.json</div></div></div></foreignObject><text x="201" y="139" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">config...</text></switch></g><path d="M 361 120 L 420 120 L 420 179 L 361 179 Z" fill="url(#mx-gradient-60a337-1-277116-1-s-0)" stroke="none" pointer-events="all"/><path d="M 408.11 151.94 L 408.43 149.66 C 411.42 151.45 411.46 152.19 411.46 152.21 C 411.45 152.21 410.94 152.63 408.11 151.94 Z M 406.47 151.48 C 401.31 149.92 394.13 146.63 391.22 145.25 C 391.22 145.24 391.23 145.23 391.23 145.22 C 391.23 144.1 390.32 143.19 389.2 143.19 C 388.09 143.19 387.18 144.1 387.18 145.22 C 387.18 146.34 388.09 147.24 389.2 147.24 C 389.69 147.24 390.14 147.06 390.49 146.77 C 393.91 148.39 401.04 151.64 406.23 153.17 L 404.18 167.67 C 404.17 167.71 404.17 167.75 404.17 167.79 C 404.17 169.07 398.52 171.41 389.28 171.41 C 379.94 171.41 374.23 169.07 374.23 167.79 C 374.23 167.75 374.23 167.71 374.22 167.68 L 369.93 136.32 C 373.65 138.87 381.64 140.23 389.28 140.23 C 396.92 140.23 404.9 138.88 408.62 136.33 Z M 369.48 133.05 C 369.54 131.94 375.91 127.59 389.28 127.59 C 402.66 127.59 409.03 131.94 409.09 133.05 L 409.09 133.42 C 408.36 135.91 400.1 138.54 389.28 138.54 C 378.45 138.54 370.19 135.9 369.48 133.41 Z M 410.78 133.06 C 410.78 130.14 402.4 125.9 389.28 125.9 C 376.16 125.9 367.79 130.14 367.79 133.06 L 367.87 133.7 L 372.55 167.86 C 372.66 171.68 382.85 173.1 389.28 173.1 C 397.26 173.1 405.74 171.26 405.85 167.86 L 407.87 153.62 C 409 153.89 409.92 154.02 410.66 154.02 C 411.66 154.02 412.34 153.78 412.74 153.29 C 413.08 152.89 413.21 152.41 413.11 151.89 C 412.89 150.73 411.51 149.47 408.69 147.86 L 410.69 133.73 Z" fill="#ffffff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 186px; margin-left: 391px;"><div data-drawio-colors="color: #232F3E; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(35, 47, 62); line-height: 1.2; pointer-events: all; white-space: nowrap;">Amazon S3</div></div></div></foreignObject><text x="391" y="198" fill="#232F3E" font-family="Helvetica" font-size="12px" text-anchor="middle">Amazon S3</text></switch></g><path d="M 114.62 215 L 176.63 215" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 181.88 215 L 174.88 218.5 L 176.63 215 L 174.88 211.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="80" y="185" width="34.62" height="60" fill="none" stroke="none" pointer-events="all"/><path d="M 112.63 185.12 L 81.99 185.12 C 80.89 185.12 80 186.02 80 187.12 L 80 242.89 C 80 243.98 80.89 244.88 81.99 244.88 L 112.63 244.88 C 113.73 244.88 114.62 243.98 114.62 242.89 L 114.62 187.12 C 114.62 186.02 113.73 185.12 112.63 185.12 Z M 82.72 242.16 L 82.72 187.84 L 111.9 187.84 L 111.9 242.16 Z M 86.02 193.94 L 108.6 193.94 L 108.6 191.22 L 86.02 191.22 Z M 86.02 199.73 L 108.6 199.73 L 108.6 197.02 L 86.02 197.02 Z M 86.02 205.75 L 108.6 205.75 L 108.6 203.04 L 86.02 203.04 Z M 86.02 211.62 L 108.6 211.62 L 108.6 208.91 L 86.02 208.91 Z" fill="#232f3d" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 252px; margin-left: 97px;"><div data-drawio-colors="color: #232F3E; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(35, 47, 62); line-height: 1.2; pointer-events: all; white-space: nowrap;">OPCUA-Server</div></div></div></foreignObject><text x="97" y="264" fill="#232F3E" font-family="Helvetica" font-size="12px" text-anchor="middle">OPCUA-...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>

At first we have to download and extract the SFC bundles. These are precompiled executeables to get started quickly. Additionaly we are going to define some basic setup values:

Basic configuration values:

```shell
# define basic configuration values
export AWS_REGION="us-east-1"
export ACCOUNT_ID=$(aws sts get-caller-identity --query "Account" --output text)
export SFC_S3_BUCKET_NAME="sfc-s3-bucket-${ACCOUNT_ID}"
```

Download and install SFC:

```shell
# Define sfc Version
export VERSION="1.0.0"

# Download and extract bundles
mkdir sfc && cd sfc
wget https://dyy8lqvmsyeqk.cloudfront.net/55b40a6/bundle/sfc-$VERSION.zip && unzip sfc-$VERSION.zip
rm sfc-$VERSION.zip

for file in *.tar.gz; do
  tar -xf "$file"
  rm "$file"
done

# Export installation folder
export SFC_DEPLOYMENT_DIR=sfc
```
### Deploy, Configure, Run
If you do not have a S3 bucket yet, you will have to create one:

```shell
aws s3api create-bucket --bucket ${SFC_S3_BUCKET_NAME} --region ${AWS_REGION}
```

Next we will have to configure the SFC. This is done via a configuration file you can specify at execution time (e.g. `sfc-main -config example.json`) We are first defining following variables which we will then use in a example configuration file. The following configuration sets SFC up, to connect to a OPCUA-Server and forward it to the S3 Bucket in your AWS Account:
<details>
  <summary>Expand</summary>

```shell
cat << EOF > example.json
  {
    "AWSVersion": "2022-04-02",
    "Name": "OPCUA to S3, using in process source and targets",
    "Version": 1,
    "LogLevel": "Info",
    "ElementNames": {
      "Value": "value",
      "Timestamp": "timestamp",
      "Metadata": "metadata"
    },
    "Schedules": [
      {
        "Name": "OpcuaToS3",
        "Interval": 50,
        "Description": "Read data of all OPCUA data types once per second and send to S3",
        "Active": true,
        "TimestampLevel": "Both",
        "Sources": {
          "OPCUA-SOURCE": [
            "*"
          ]
        },
        "Targets": [
          "S3Target"
        ]
      }
    ],
    "Sources": {
      "OPCUA-SOURCE": {
        "Name": "OPCUA-SOURCE",
        "ProtocolAdapter": "OPC-UA",
        "AdapterOpcuaServer": "OPCUA-SERVER-1",
        "Description": "OPCUA local test server",
        "SourceReadingMode": "Polling",
        "SubscribePublishingInterval": 100,
        "Channels": {
          "ServerStatus": {
            "Name": "ServerStatus",
            "NodeId": "ns=0;i=2256"
          },
          "ServerTime": {
            "Name": "ServerTime",
            "NodeId": "ns=0;i=2256",
            "Selector": "@.currentTime"
          },
          "State": {
            "Name": "State",
            "NodeId": "ns=0;i=2259"
          },
          "Machine1AbsoluteErrorTime": {
            "Name": "AbsoluteErrorTime",
            "NodeId": "ns=21;i=59048"
          },
          "Machine1AbsoluteLength": {
            "Name": "AbsoluteLength",
            "NodeId": "ns=21;i=59066"
          },
          "Machine1AbsoluteMachineOffTime": {
            "Name": "AbsoluteMachineOffTime",
            "NodeId": "ns=21;i=59041"
          },
          "Machine1AbsoluteMachineOnTime": {
            "Name": "AbsoluteMachineOnTime",
            "NodeId": "ns=21;i=59050"
          },
          "Machine1AbsolutePiecesIn": {
            "Name": "AbsolutePiecesIn",
            "NodeId": "ns=21;i=59068"
          },
          "Machine1FeedSpeed": {
            "Name": "FeedSpeed",
            "NodeId": "ns=21;i=59039"
          }
        }
      }
    },
    "Targets": {
      "DebugTarget": {
        "Active": true,
        "TargetType": "DEBUG-TARGET"
      },
      "S3Target": {
        "Active": true,
        "TargetType": "AWS-S3",
        "Region": "us-east-1",
        "BucketName": "${SFC_S3_BUCKET_NAME}",
        "Interval": 60,
        "BufferSize": 1,
        "Prefix": "opcua-data",
        "Compression": "None"
      }
    },
    "TargetTypes": {
      "DEBUG-TARGET": {
        "JarFiles": [
          "${SFC_DEPLOYMENT_DIR}/debug-target/lib"
        ],
        "FactoryClassName": "com.amazonaws.sfc.debugtarget.DebugTargetWriter"
      },
      "AWS-S3": {
        "JarFiles": [
          "${SFC_DEPLOYMENT_DIR}/aws-s3-target/lib"
        ],
        "FactoryClassName": "com.amazonaws.sfc.awss3.AwsS3TargetWriter"
      }
    },
    "AdapterTypes": {
      "OPCUA": {
        "JarFiles": [
          "${SFC_DEPLOYMENT_DIR}/opcua/lib"
        ],
        "FactoryClassName": "com.amazonaws.sfc.opcua.OpcuaAdapter"
      }
    },
    "ProtocolAdapters": {
      "OPC-UA": {
        "AdapterType": "OPCUA",
        "OpcuaServers": {
          "OPCUA-SERVER-1": {
            "Address": "opc.tcp://localhost",
            "Path": "/",
            "Port": 4840,
            "ConnectTimeout": "10000",
            "ReadBatchSize": 500
          }
        }
      }
    }
  }
EOF
```

</details>

With everything being set up you can start the OPC UA server and the SFC itself:

```shell
# start umati opc-ua sample server
finch run -d -p 4840:4840 ghcr.io/umati/sample-server:main

# run sfc
sfc-main/bin/sfc-main -config example.json -info
```